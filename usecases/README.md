# usecases

## 领域场景

1. web 端

### 领域词条

1. 用户

2. 读者----》用户

3. 作者----》用户

## 创作文章用例

### 用户打草稿

用户打开一个草稿-----》用户编辑草稿-----》用户创建草稿------》用户保存草稿------》用户发布草稿

用户选择一个草稿编辑----》用户编辑草稿 -----》用户保存草稿（draft) -----》用户发布草稿为文章(article)

1. 草稿与文章的使用场景描述

   1. 草稿的使用场景

      1. 用户打开一个草稿----》用户写文章------》用户保存文章

      2. 用户查看草稿列表-----》选择要编辑的草稿----》用户编辑草稿-------》用户保存草稿-------》用户发布草稿

   2. 文章的使用场景

      1. 作者查看自己的已发布文章列表-----》点击文章查看详情

      2. 用户查看分页查看已发布文章-----》点击文章查看详情

2. 设计的目的

   1. 区分已发布文章和未发布文章

3. 设计草稿与文章：使用 status 来区分草稿与文章

4. 用例

   1. 文章没发布作者在自己的草稿列表中查看文章

   2. 文章已发布作者在自己的已发布文章列表中查看

   3. 用户在文章列表中查看已发布文章

### 用户修改已发布文章

1. 用户查看已发布文章---》用户选择已发布文章编辑-----》用户编辑已发布文章------》用户保存文章------》系统创建草稿保存文章---------》用户发布最新文章更新

2. 用户查看已发布文章---》用户选择已发布文章编辑-----》用户编辑已发布文章------》用户保存文章------》系统保存更新修改到草稿中---------》用户发布最新文章更新

3. 用例场景描述

   1. 用户编辑已发布文章保存到草稿中

   2. 用户发布草稿中的文章

4. 设计目的

   1. 用户发布文章后可以进行二次创作，且不影响读者查看已完成内容

   2. 作者二次创作的内容只有作者创作完成发布后读者才能查看

5. 设计

   1. 用户编辑的已发布文章保存到一个副本储存区域中，每次修改都是修改这个副本

   2. 用户发布修改，更新副本内容到文章中

6. 用例

   1. 用户编辑已发布文章，编辑保存到副本存储区域

   2. 用户编辑的文章未发布时其它用户查看的是原内容，用户发布文章，其它用户看见最新内容

### 用户查看文章详情

用户查看文章列表---》用户查看文章详情

1. 用例场景描述

   1.用户查看文章列表--------》点击文章查看详情

2. 设计的目的

   1. 用户查看文章列表，点击文章查看详情,用户如何获取文章详情

3. 用例的设计

   设计一：

   1. 在用户查看了文章列表后，要查看文章详情时通过文章标题查找到文章

      1. 找到的文章可能重复，这并不是搜索文章，如果搜索文章可能存在多篇满足条件的文章

   设计二：

   1. 设计一个 ID 到文章属性中，每篇文章都有一个唯一的 ID，查找文章详情通过 ID 找到唯一的文章

   2. 生成方式：设计一个序列发生器生成 ID

      ```
      interface IDGenerator {
        //生成数字类型的ID
        NumberID() int
      }
      ```

4. 用例测试

   1. 每篇文章 ID 保证是在所有文章全家唯一的

### 文章自动保存

1.用例场景

1. 由于存在突然断电、系统崩溃、作者忘记点击保存按钮就关闭页面等情况，导致作者创作，编辑的内容丢失，造成不好的体验

2. 设计目的

   1. 减少意外损失，防止意外

   2. 让作者更专注内容创作

3. 用例描述

   1. 用户编辑文章，系统自动保存文章内容到一个安全的地方

4. 设计

   1. 用户如何自动保存文章内容

      1. 定时保存

      2. 实时保存

   2. 用户保存文章到哪里

      1. 本地

      2. 远程

5. 用例设计

   1. 用户编辑文章时，系统实时保存文章到本地

   2. 系统定时同步内容到远程

   3. 当系统启动时同步一次内容到远程

## 用户注册、登录用例、退出登录

用户注册---》用户登录系统-----》用户退出登录

1. 场景描述

   1. 用户创作文章知道创作者，用户可以在多端（手机端、网站）查看和编辑创作的文章

   2. 用户发布文章时鉴权

2. 设计的目的

   1. 在用户创作文章、发布文章知道是谁在操作和用户是否有权限

### 用户注册

1. 场景描述

   1. 用户创作、编辑文章和查看个人创作文章列表，系统都需要知道用户是谁

2. 设计的目的

   1. 为了避免用户每次操作都输入个人信息，让用户先在系统中注册个人信息

3. 用例设计

   1. 用户输入用户名、邮箱、密码注册成功

   2. 用户输入的邮箱已注册过，注册失败

### 用户登录

1. 用例场景

   用户在系统中输入用户名、密码登录系统,登录成功返回登录凭证客户端保存

2. 用例设计目的

   1. 用户编辑、发布文章的时候需要鉴权

   2. 用户在系统中创作文章时需要知道作者

3. 设计

   1. 用例一：用户名密码登录

   2. 用例二：手机快捷登录

   3. 用例三：Facebook、微信、QQ 等第三方授权登录

#### 用户名密码登录

1. 用例描述

用户输入用户名、密码登录，系统校验用户名、密码正确，登录成功返回登录凭证

2. 用例交互

```
//user login by user name and password
User                                         系统
---------------1 username and password ------->login(){
                                                    verifyUserAndPassword()
                                                     token := generateToken()
                                                     return token
                                                  }

<--------------2 token success-----------------------

```

#### 用户快捷登录

用户输入手机号-------》系统生成手机验证码--------------》系统发送验证码到用户手机号----------》用户输入验证码----------》系统校验验证码--------》用户登录

1. 用例描述

```

// user mobile login
   O
  /|\ -------(API)-----------> 系统 ( high order function , lambda )
   /\                                  高阶函数在哪一层组合????
User                            系统
-------1 mobile number-------> getMobileVerifyCodeForLogin(){
        GenerateMobileVerifyCode();
        SaveVerifyCode();
        return verifyCode}  GenerateMobileVerifyCode()
<------2 verify code(gsm)----- sendVerifyCode
-------3 verify code---------> login(){
                                  if(verify()) {
                                    GetUserByPhone()
                                    tokenSuccess, err := getTokenSuccess();   // token sub domain (session sub
                                    domain)
                                    return tokenSuccess;
                                  }
                                  return failed
                               }
<------4 token success--------
```

```
login()  -----------> * rpc */ login()

login()  ---> login() --> base functions { sub domain }
```

2. 设计目的

   1. 方便用户通过手机号快捷登录

3. 用例

   1. 系统生成手机验证码

      1. 由生成验证码服务生成手机验证码

      ```
      struct VerifyCode {

      }
      generate()
      verify()
      ```

   2. 发送验证码给用户

   3. 抽取发送手机信息子域

      type MessageInfo struct{
      iphone string
      messag string
      }

      ```
        type SendMessagService interface {
          Send()
        }
      ```

4. 校验验证码

5. 用户登录

#### 第三方授权登录

todo

### 多端同步登录

todo

### 用户注册时邮箱校验

1. 用例描述

   1. 用户输入邮箱---》用户点击生成验证码-----》系统向用户邮箱发送验证码-----》用户查看邮箱输入验证码------》系统校验验证码是否正确

2. 设计目的

   1. 防止用户输错成别人邮箱注册系统导致后续无法接收通知和别人无法使用该邮箱注册系统

3. 用例

   1. 系统生成验证码(考虑验证生成拆分出验证码通用子领域)

      1. 抽取生成验证码为公共子域

      ```
         type VerificationCode{
              code string
         }
         //验证码校验接口
         type VerificationCodChecker interface {
              IfIsCorrect() //判断验证码是否正确
         }
         interface VerificationCodeGeneratorService{
            Generate() //生成验证码
         }
      ```

   2. 系统发送验证码到邮箱(邮箱服务子领域)

      1. 抽取邮箱服务公共子域

      ```
        type EmailSenderService interface {
            Send() //发送邮件
        }
      ```

   3. 校验邮箱验证码是否正确

      1. 添加验证码校验接口到验证码生成服务公共子领域

### 用户更换邮箱时邮箱校验

1. 用例描述

   1. 用户点击校验邮箱-----》发送验证码到邮箱------》校验邮箱验证码是否正确

2. 设计目的

   1. 防止更换邮箱时输错邮箱，导致读者联系不了作者

3. 用例

   1. 系统生成用户邮箱验证码

   2. 系统发送验证码到邮箱

   3. 系统校验用户验证码是否正确

### 校验用户是否登录

1. 用例描述

   1. 客户端发送登录凭证，服务端校验是否登录

2. 设计目的

   1. 由于 http 的无状态，校验用户的登录状态

   2. 鉴权用户身份

3. 用例设计

```
  User                  System
  --------- 1 token-------> IsLoggedIn()
  ----------2 isLogin-----

```

    1. 登录凭证有效，用户已登录

    2. 登录凭证无效，用户未登录

### 用户退出登录

1. 用例描述

   1. 用户点击退出登录按钮退出登录状态

2. 设计目的

   1. 保证自己账户的安全

      1. 用户可能在公共场所登录

3. 用例设计

   1. 用户退出登录，清空登录状态记录

## 用户评论文章用例

用户评论文章-----》用户回复

1. 用例描述

   1. 用户在文章下面发表评论-----》其他用户查看文章评论------》其他用户选择想要回复的评论回复

2. 设计目的

   1. 方便用户针对文章疑问与作者交流

### 用户评论文章

1. 用例描述

   1. 用户查看文章有问题，在文章下面发表评论与作者交流疑问

2. 设计目的

   1. 用户在浏览文章之后如果有疑问可以直接在文章中发表与作者沟通对文章的疑问

3. 设计

   1. 设计文章评论结构体实现对文章的评论

4. 用例

   1. 用户评论文章，文章存在评论成功，不存在评论失败

   2. 用户删除评论

### 作者或者其他用户回复文章评论

1. 用例描述

   1. 作者或其他用户查看文章下面的评论，选择评论回复，解答读者对文章的疑惑。

   2. 作者浏览评论，删除不文明的评论

2. 设计目的

   1. 作者或其他用户看到文章下面评论可以进行回复解答来互相交流学习

   2. 作者可以删除文章中不合理的评论来保持干净的学习氛围

3. 用例

   1. 用户查看文章评论列表

   2. 用户回复文章评论

   3. 作者删除评论
