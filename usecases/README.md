# usecases

## 创作文章用例

### 用户打草稿

用户打开一个草稿/用户选择一个草稿编辑----》用户编辑文章 -----》用户保存草稿（draft) -----》用户发布草稿为文章(article)

1. 草稿与文章的使用场景描述

   1. 草稿的使用场景

      1. 用户打开一个草稿----》用户写文章------》用户保存文章

      2. 用户查看草稿列表-----》选择要编辑的草稿----》用户编辑草稿-------》用户保存草稿-------》用户发布草稿

   2. 文章的使用场景

      1. 作者查看自己的已发布文章列表-----》点击文章查看详情

      2. 用户查看分页查看已发布文章-----》点击文章查看详情

2. 设计的目的

   1. 区分已发布文章和未发布文章

3. 设计草稿与文章：使用 status 来区分草稿与文章

4. 用例

   1. 文章没发布作者在自己的草稿列表中查看文章

   2. 文章已发布作者在自己的已发布文章列表中查看

   3. 用户在文章列表中查看已发布文章

### 用户修改已发布文章

用户查看已发布文章---》用户选择已发布文章编辑-----》用户编辑已发布文章------》用户保存编辑---------》用户发布最新文章更新

1. 用例场景描述

   1. 用户编辑已发布文章保存到草稿中

   2. 用户发布草稿中的文章

2. 设计目的

   1. 用户发布文章后可以进行二次创作，且不影响读者查看已完成内容

   2. 作者二次创作的内容只有作者创作完成发布后读者才能查看

3. 设计

   1. 用户编辑的已发布文章保存到一个副本储存区域中，每次修改都是修改这个副本

   2. 用户发布修改，更新副本内容到文章中

4. 用例

   1. 用户编辑已发布文章，编辑保存到副本存储区域

   2. 用户编辑的文章未发布时其它用户查看的是原内容，用户发布文章，其它用户看见最新内容

### 用户查看文章详情

用户查看文章列表---》用户查看文章详情

1. 用例场景描述

   1.用户查看文章列表--------》点击文章查看详情

2. 设计的目的

   1. 用户查看文章列表，点击文章查看详情能找到对应的文章详情

3. 用例的设计

   设计一：

   1. 在用户查看了文章列表后，要查看文章详情时通过文章标题查找到文章

      1. 找到的文章可能重复，这并不是搜索文章，如果搜索文章可能存在多篇满足条件的文章

   设计二：

   1. 设计一个 ID 到文章属性中，每篇文章都有一个唯一的 ID，查找文章详情通过 ID 找到唯一的文章

   2. 生成方式：

      设计一个序列发生器生成 ID

4. 用例测试

   1. 每篇文章 ID 保证是在所有文章全家唯一的

### 文章定时保存

1.用例场景

1. 由于存在突然断电、系统崩溃、作者忘记点击保存按钮就关闭页面等情况，导致作者创作，编辑的内容丢失，造成不好的体验

2. 设计目的

   1. 减少意外损失，防止意外

   2. 让作者更专注内容创作

3. 用例描述

   1. 用户编辑文章，系统自动保存文章内容到一个安全的地方

4. 设计

   1. 用户如何自动保存文章内容

      1. 定时保存

      2. 实时保存

   2. 用户保存文章到哪里

      1. 本地

      2. 远程

5. 用例设计

   1. 用户编辑文章时，系统实时保存文章到本地

   2. 系统定时同步内容到远程

   3. 当系统启动时同步一次内容到远程

## 用户注册、登录用例、退出登录

用户注册---》用户登录系统-----》用户退出登录

1. 场景描述

   1. 用户创作文章知道创作者，用户可以在多端（手机端、网站）查看和编辑创作的文章

   2. 用户发布文章时鉴权

2. 设计的目的

   1. 在用户创作文章、发布文章知道是谁在操作和用户是否有权限

3. 设计

   1. 设计一：每次用户进行创作文章、发布文章等操作时输入用户个人信息（用户名、密码）等信息

      1. 因为用户可能多次创作、编辑文章，如果每次都要在操作时输入用户个信息知道用户是谁，对于用户操作很麻烦，也很容易出错

      2. 如果是让用户填调查报告，或推广产品时让未注册用户扫码抽奖这种场景下虽然也需要知道用户信息，但是用户只是一次使用系统，让用户注册一下再操作反而更麻烦，在这种情况下用户手动输入一次个人信息可能更方便

   2. 设计二：让用户注册一次个人信息保存到系统，然后在使用系统前登录系统

### 用户注册

1. 场景描述

   1. 用户创作、编辑文章和查看个人创作文章列表，系统都需要知道用户是谁

2. 设计的目的

   1. 为了避免用户每次操作都输入个人信息，让用户先在系统中注册个人信息

✅ `用户注册`上述部分很干净.

3. 用例设计

   1. 用户输入用户名、邮箱、密码注册成功

   2. 用户输入的邮箱已注册过，注册失败

### 用户登录

1. 用例场景

   用户在系统中输入用户名、密码登录系统,登录成功系统保存用户的登录状态

2. 用例设计目的

   1. 用户编辑、发布文章的时候需要鉴权

   2. 用户在系统中创作文章时知道作者

3. 设计

   1. 用户输入用户名（是什么）、密码，校验用户名密码

      1. 用户名如何设计

   2. 用户名密码正确，生成 token 返回给客户端保存

      1. 为什么要生成 token

      2. token 如何设计

### 用户登录

1. 用例场景描述

<!-- > 1. 用户虽然注册过系统，但是为了知道当前操作系统是谁，用户需要向系统表明身份 -->

用户输入用户名、密码登录系统

⚠️ 想一想,你说的这句话,是否是在做用例场景描述?

    ("用户虽然注册过系统"),这句话在这里多余,可删除.
    ("但是为了知道当前操作系统是谁"),这句话表述有问题.
    ("用户需要向系统表明身份").虽然表述上还是文绉绉的.

1.  因为这个是 UseCase, 例如: (1. UseCase of Web App(Browser), 2. UseCase of IPhone(Android, Desktop(MacOS, Windows10...))

    先缩小范围,取一个

    UseCase of Web App:

        1. 用户打开网址, 点击一个登录按钮,输入用户名密码点击登录.

    UseCase of IPhone App:

        1. 用户打开App, 输入用户名密码点击登录.
        (有些应用是强制登录,比如zhihu App, 有些App是则是需要时登录,比如购物应用,Amazon, jd,
        taobao等),这里描述是你的领域需求相关的场景.

接下来看下面的目的描述:

2.  目的

> 1.  用户输入信息向系统表明身份，系统校验用户身份

    (上面这句话有点啰嗦啊,前后两句表述的是一个意思)

    1. 用户在发表Article, 修改和删除自己的文章需要鉴权;(或者,某些服务需要用用户授权访问)

> 2.  系统登记用户的登录身份，这样在每次操作时都能知道用户是谁

    总结式描述.(UseCase是指描述场景,不是描述可能性,或适用范围)

3.  用例设计

> 1.  用户输入部分个人信息校验用户身份，如何校验用户身份？

    1. 用户输入身份识别信息，如何校验用户身份？

>       1. 设计一：用户输入用户名、密码校验，由于用户名可能重复，不行

       ⚠️  用户登录ID,需要唯一性,用户名可能重复(比如可能存在两个现实中都叫‘张小明’的人),

>       2. 设计二：用户输入 ID 和密码校验，ID 不方便用户记住，不行

       ✅

       3. 设计三：用户输入邮箱或电话号码校验，邮箱或电话号码用户经常使用，方便记住，且用户的邮箱或者手机号是唯一的
       现实中方便记忆,又具备唯一性的,比较适合用在一些安全要求不高的场景,上述没问题,
       那如果是金融部分的话,这类信息往往直接具备现实中暴露目标的安全问题,所以银行系统中,身份识别是芯片id.


    2. 记住用户的登录行为，由于网络的无状态，且同一个客户端可以有多个人操作登录系统，为了避免用户每次都要登录，需要生成一个凭证保存在客户端来校验用户是否登录和登录的用户是谁

       设计：

       1. 校验用户身份成功

       2. 生成一个 token 给客户端

       3. 客户端登保存 token，每次请求携带给客户端，客户端通过 token 校验用户是否登录
       4. 通过 token 在服务端获取用户信息

4.  用例测试

    1. 用户输入正确的邮箱和密码校验用户身份成功，用户明密码错误校验不成功

    2. 用户身份校验成功，生成 token，保存用户登录登录状态在服务端

    3. 用户登录后客服端携带 token 请求信息时服务端校验用户登录状态成功

### 用户注册时邮箱校验

1. 用例描述

   1. 用户输入邮箱---》用户点击生成验证码-----》系统向用户邮箱发送验证码-----》用户查看邮箱输入验证码------》系统校验验证码是否正确

2. 设计目的

   1. 防止用户输错成别人邮箱注册系统导致后续无法接收通知和别人无法使用该邮箱注册系统

3. 用例

   1. 系统生成验证码(考虑验证生成拆分出验证码通用子领域)

      1. 抽取生成验证码为公共子域

      ```
         type VerificationCode{
              code string
         }
         //验证码校验接口
         type VerificationCodChecker interface {
              IfIsCorrect() //判断验证码是否正确
         }
         interface VerificationCodeGeneratorService{
            Generate() //生成验证码
         }
      ```

   2. 系统发送验证码到邮箱(邮箱服务子领域)

      1. 抽取邮箱服务公共子域

      ```
        type EmailSenderService interface {
            Send() //发送邮件
        }
      ```

   3. 校验邮箱验证码是否正确

      1. 添加验证码校验接口到验证码生成服务公共子领域

### 用户更换邮箱时邮箱校验

1. 用例描述

   1. 用户点击校验邮箱-----》发送验证码到邮箱------》校验邮箱验证码是否正确

2. 设计目的

   1. 防止更换邮箱时输错邮箱，导致读者联系不了作者

3. 用例

   1. 系统生成用户邮箱验证码

   2. 系统发送验证码到邮箱

   3. 系统校验用户验证码是否正确

### 用户快捷登录

1. 用例描述

   用户输入手机号-------》系统生成手机验证码--------------》系统发送验证码到用户手机号----------》用户输入验证码----------》系统校验验证码--------》用户登录

2. 设计目的

   1. 方便用户通过手机号快捷登录

3. 用例

   1. 系统生成手机验证码

      1. 由生成验证码服务生成手机验证码

   2. 发送验证码给用户

      1. 抽取发送手机信息子域

      ```
        type SendMessagService interface {
          Send()
        }
      ```

   3. 校验验证码

   4. 用户登录

### 第三方授权登录

todo

### 多账号登录

### 校验用户是否登录

1. 用例描述

客户端发送登录凭证，服务端校验是否登录

2. 设计目的

由于 http 的无状态，用户登录之后为了避免用户每次操作都要登录

3. 用例设计

1. 登录凭证有效，登录成功

1. 登录凭证无效，登录失败

### 用户退出登录

1. 用例描述

   1. 用户点击退出登录按钮退出登录状态

2. 设计目的

   1. 保证自己账户的安全

      1. 用户可能在公共场所登录

3. 用例设计

   1. 用户退出登录，清空登录状态记录

## 用户评论文章用例

用户评论文章-----》用户回复

1. 用例描述

   1. 用户在文章下面发表评论-----》其他用户查看文章评论------》其他用户选择想要回复的评论回复

2. 设计目的

   1. 方便用户针对文章疑问与作者交流

### 用户评论文章

1. 用例描述

   1. 用户查看文章有问题，在文章下面发表评论与作者交流疑问

2. 设计目的

   1. 用户在浏览文章之后如果有疑问可以直接在文章中发表与作者沟通对文章的疑问

3. 设计

   1. 设计文章评论结构体实现对文章的评论

4. 用例

   1. 用户评论文章，文章存在评论成功，不存在评论失败

   2. 用户删除评论

### 作者或者其他用户回复文章评论

1. 用例描述

   1. 作者或其他用户查看文章下面的评论，选择评论回复，解答读者对文章的疑惑。

   2. 作者浏览评论，删除不文明的评论

2. 设计目的

   1. 作者或其他用户看到文章下面评论可以进行回复解答来互相交流学习

   2. 作者可以删除文章中不合理的评论来保持干净的学习氛围

3. 用例

   1. 用户查看文章评论列表

   2. 用户回复文章评论

   3. 作者删除评论
